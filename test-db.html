<!DOCTYPE html>
<html>
<head>
    <title>Firebase Database Test</title>
</head>
<body>
    <h1>Firebase Database Configuration Test</h1>
    <div id="status">Testing...</div>
    <div id="details"></div>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDJOuYk3sUoQkkqX4tH3e8P9Gh1kXBRJ8A",
            authDomain: "preventive-maintenance-2b1b7.firebaseapp.com",
            databaseURL: "https://preventive-maintenance-2b1b7-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "preventive-maintenance-2b1b7",
            storageBucket: "preventive-maintenance-2b1b7.firebasestorage.app",
            messagingSenderId: "781770447532",
            appId: "1:781770447532:web:5f90c90bfcde2e2ca51d09"
        };

        const status = document.getElementById('status');
        const details = document.getElementById('details');

        try {
            // Initialize Firebase
            firebase.initializeApp(firebaseConfig);
            status.innerHTML = '✅ Firebase initialized successfully';
            details.innerHTML += '<p><strong>Config:</strong></p><pre>' + JSON.stringify(firebaseConfig, null, 2) + '</pre>';

            // Test database connection
            const db = firebase.database();
            details.innerHTML += '<p>✅ Database object created</p>';

            // Try to read/write a test value
            const testRef = db.ref('test_connection');
            testRef.set({
                timestamp: new Date().toISOString(),
                message: 'Connection test'
            }).then(() => {
                details.innerHTML += '<p>✅ Successfully wrote to database</p>';
                return testRef.once('value');
            }).then((snapshot) => {
                details.innerHTML += '<p>✅ Successfully read from database</p>';
                details.innerHTML += '<pre>' + JSON.stringify(snapshot.val(), null, 2) + '</pre>';
            }).catch((error) => {
                details.innerHTML += '<p style="color:red">❌ Database error: ' + error.message + '</p>';
                details.innerHTML += '<p>Error code: ' + error.code + '</p>';
            });

        } catch (error) {
            status.innerHTML = '❌ Error: ' + error.message;
            details.innerHTML = '<pre>' + error.stack + '</pre>';
        }
    </script>
</body>
</html>
